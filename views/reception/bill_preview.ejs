<div class="container py-4 w-50">
  <div class="card shadow-sm">
    <div class="card-header bg-light">
      <h4 class="text-success mb-0">ğŸ’µ Bill Summary for <%= patient_name %></h4>
    </div>

    <div class="card-body">
      <table class="table">
        <tbody>
          <!-- Room Charges -->
          <tr>
  <th scope="row">ğŸ›ï¸ Room Charges</th>
  <td>
    â‚¹ <%= roomCharges.toFixed(2) %><br>
    <% if (admission) { %>
      <small class="text-muted">
        <%= admission.room_type %> room (â‚¹<%= admission.charges_per_day %>/day) Ã— <%= stayDays %> days
      </small>
    <% } else { %>
      <small class="text-muted text-danger">No admission record</small>
    <% } %>
  </td>
</tr>


          <!-- Nurse Charges -->
          <tr>
            <th>ğŸ§‘â€âš•ï¸ Nurse Charges</th>
            <td>
              â‚¹ <%= nurseCharges.toFixed(2) %><br>
              <% if (nurseDetail) { %>
                <small class="text-muted">
                  Assigned Nurse: <%= nurseDetail.nurse_name %> (â‚¹500/day Ã— <%= stayDays %> days)
                </small>
              <% } else { %>
                <small class="text-muted">No nurse assigned</small>
              <% } %>
            </td>
          </tr>

          <!-- Treatment Charges -->
          <tr>
            <th>ğŸ‘¨â€âš•ï¸ Treatment Charges</th>
            <td>
              â‚¹ <%= treatmentCharges.toFixed(2) %><br>
              <small class="text-muted">Flat consultation/procedure fee</small>
            </td>
          </tr>

          <!-- Medicine Charges -->
          <tr>
            <th>ğŸ’Š Medicine Charges</th>
            <td>
              â‚¹ <%= medicineCharges.toFixed(2) %>
              <% if (medicineBreakdown.length > 0) { %>
                <ul class="mb-0 small text-muted mt-1">
                  <% medicineBreakdown.forEach(med => { %>
                    <li><%= med.medicine_name %> (â‚¹<%= med.price %> Ã— <%= med.quantity %>) = â‚¹<%= (med.price * med.quantity).toFixed(2) %></li>
                  <% }) %>
                </ul>
              <% } else { %>
                <br><small class="text-muted">No prescriptions found</small>
              <% } %>
            </td>
          </tr>

          <!-- Total -->
          <tr class="table-light">
            <th>ğŸ§¾ Total Amount</th>
            <td><strong>â‚¹ <%= totalAmount.toFixed(2) %></strong></td>
          </tr>
        </tbody>
      </table>

      <p class="text-muted">ğŸ—“ï¸ Billing Date: <%= new Date(billing_date).toLocaleDateString() %></p>
    </div>

    <div class="card-footer d-flex justify-content-end">
      <a href="/reception/patients" class="btn btn-outline-secondary me-2">ğŸ”™ Back</a>
      <a href="/reception/bill/generate/<%= patientId %>" class="btn btn-success">ğŸ’¾ Save Bill</a>
    </div>
  </div>
</div>
